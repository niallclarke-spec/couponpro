GOAL
Build a modern, easy-to-use **Telegram Journey Builder (V1)** inside the dashboard that allows tenants to create and manage up to **6 journeys**, using the backend Journeys system that already exists (journeys, journey_steps, journey_triggers, etc.).

This is a PRODUCT FEATURE, not a refactor. The backend journeys engine already works â€” this task is about exposing it cleanly in the dashboard and wiring it correctly.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸš« ABSOLUTE HARD CONSTRAINTS (DO NOT VIOLATE)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1) âŒ DO NOT PUT LOGIC IN server.py
- server.py must remain THIN.
- No UI logic, no business logic, no dispatch logic.
- Only allow **thin wrapper methods** (delegate â†’ domain handlers).
- server.py must stay under ~400 lines.
- NO if/elif routing chains.
- ALL routing must go through:
  - api/routes.py
  - api/dispatch.py
  - domain handler modules

2) âŒ DO NOT MIX UI + BACKEND LOGIC
- UI lives in HTML + JS only.
- Backend logic lives in domains/journeys/.

3) âŒ DO NOT BREAK EXISTING JOURNEYS
- Existing seeded journeys must continue working.
- Telegram deep links like:
  t.me/YourBot?start=broker_signup
  must keep working exactly as they do now.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… WHAT TO BUILD (FUNCTIONAL REQUIREMENTS)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

A) JOURNEY BUILDER UI (Dashboard)

Add a new sidebar item:
- **â€œJourneysâ€**

This opens a **Journeys Management Page** with:

1) Journeys List View
- Shows all journeys for the tenant (max 6)
- Columns:
  - Name
  - Status (Draft / Active / Paused)
  - Trigger (e.g. /start broker_signup)
  - Bot used
- Actions:
  - Edit
  - Pause / Activate
  - Delete

2) Create / Edit Journey
Form-based editor (NOT a visual flow builder yet).

Fields:
- Journey name
- Description (internal notes)
- Telegram bot (select from tenantâ€™s connected bots)
- Trigger type (V1 only):
  - Telegram Deep Link
- Deep link param (e.g. broker_signup)

3) Journey Steps Editor
- Linear steps only (V1)
- Max 10 steps per journey
- Step types:
  - Message (text)
  - Question (text + answer_key)
  - Delay (min/max minutes)
- Ability to:
  - Add step
  - Edit step
  - Reorder steps (up/down)
  - Delete step

4) Activation Controls
- Journeys start as Draft
- Only Active journeys respond to Telegram triggers
- Clear warning when activating:
  â€œThis journey will go live immediately for your Telegram bot.â€

B) TENANT RULES
- Each tenant:
  - Max 6 journeys
  - Journeys are fully tenant-isolated
- Bots selectable only from tenantâ€™s connected bots
- No cross-tenant visibility

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”— BACKEND INTEGRATION (ALREADY EXISTS â€” USE IT)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

You MUST reuse the existing Journeys backend:
- journeys
- journey_triggers
- journey_steps
- journey_user_sessions
- journey_scheduled_messages

Allowed backend work:
- Add or adjust API endpoints ONLY if needed for UI
- Place handlers in:
  domains/journeys/handlers.py
- DB access via:
  domains/journeys/repo.py

Routes must be added to:
- api/routes.py

server.py:
- Only add thin wrapper methods that call domain handlers.
- No logic.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“ REQUIRED FILE STRUCTURE (STRICT)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Frontend:
- handlers/pages.py (serve the page)
- journeys.html (or integrated into app.html if thatâ€™s the pattern)
- ui/journeys/journeys.js  â† ALL Journey UI logic
- ui/journeys/journeys.css â† Journeys styling only

Backend:
- domains/journeys/handlers.py
- domains/journeys/repo.py
- api/routes.py
- api/dispatch.py (no changes unless required)

Tests:
- Add or extend tests to ensure:
  - server.py size does not increase
  - Journeys routes require auth
  - Tenant isolation is preserved

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ¨ UX EXPECTATIONS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

- Clean, modern UI
- No clutter
- Simple forms
- Clear empty states:
  â€œYou havenâ€™t created any journeys yet.â€
- Friendly copy, not technical language
- Errors shown in UI (not console-only)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âš ï¸ V1 LIMITATIONS (DO NOT BUILD YET)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

- No branching logic
- No conditional steps
- No A/B testing
- No Stripe-triggered journeys
- No analytics dashboard
- No media messages
- No multi-bot journeys

Linear flows only.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§ª ACCEPTANCE CHECKLIST
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

- Journeys appear in dashboard
- Creating a journey saves correctly
- Activating a journey makes Telegram deep links work
- server.py stays thin
- Coupon bot and existing Telegram bots still work
- No auth or tenant regressions

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Proceed step-by-step.
Do NOT refactor unrelated systems.
Do NOT add shortcuts.
Ask for confirmation ONLY if a decision materially affects architecture.